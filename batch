@echo off
setlocal

if "%~1"=="" (
    echo Usage: %~nx0 [source_folder] [output_folder]
    exit /b 1
)

if "%~2"=="" (
    echo Usage: %~nx0 [source_folder] [output_folder]
    exit /b 1
)

set "sourceFolder=%~1"
set "outputFolder=%~2"

if not exist "%outputFolder%" (
    mkdir "%outputFolder%"
)

rem Recursively find and extract all .zip files into the same output folder
for /r "%sourceFolder%" %%F in (*.zip) do (
    echo Extracting "%%F" to "%outputFolder%"
    powershell -NoLogo -NoProfile -Command ^
        "Expand-Archive -LiteralPath '%%F' -DestinationPath '%outputFolder%' -Force"
)

echo Done.
en
dlocal
