@echo off
setlocal enabledelayedexpansion

if "%~1"=="" (
    echo Usage: %~nx0 [folder_path]
    exit /b 1
)

rem Recursively find and extract all .zip files
for /r "%~1" %%F in (*.zip) do (
    set "zipFile=%%F"
    set "outputFolder=%%~dpF%%~nF"
    if not exist "!outputFolder!" (
        mkdir "!outputFolder!"
    )
    powershell -NoLogo -NoProfile -Command ^
        "Expand-Archive -LiteralPath '!zipFile!' -DestinationPath '!outputFolder!' -Force"
    echo Extracted: !zipFile! to !outputFolder!
)

echo Done.
endlo
cal
